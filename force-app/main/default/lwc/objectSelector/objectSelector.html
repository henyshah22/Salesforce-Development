<template>
    <template if:true={showSection1}>
        <p style="font-weight: bold;">Select Object</p>
        <lightning-combobox
            name="objectSelector"
            value={selectedObject}
            placeholder="Select an Object"
            options={objectOptions}
            style="margin-bottom: 16px; margin-top: -16px"
            onchange={handleObjectChange}>
        </lightning-combobox>

        <template if:true={hasRecords}>
            <table class="slds-table slds-table_cell-buffer slds-table_bordered" style="width: 100%; margin: 0 auto;">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th scope="col" style="width: 50%;">
                            <div class="slds-truncate" title="Select">Select</div>
                        </th>
                        <th scope="col" style="width: 50%;">
                            <div class="slds-truncate" title="Name">Name</div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={paginatedRecords} for:item="rec">
                        <tr key={rec.Id}>
                            <td>
                                <lightning-input
                                    type="checkbox"
                                    checked={rec.checked}
                                    data-id={rec.Id}
                                    onchange={handleCheckboxChange}>
                                </lightning-input>
                            </td>
                            <td>
                                <div class="slds-truncate">{rec.Name}</div>
                            </td>
                        </tr>
                    </template>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="2" style="text-align: center; padding: 8px;">
                            <lightning-button
                                label="Previous"
                                onclick={handlePreviousPage}
                                disabled={isPreviousDisabled}
                                variant="neutral"
                                class="slds-m-right_x-small">
                            </lightning-button>
                            <span>Page {currentPage} of {totalPages}</span>
                            <lightning-button
                                label="Next"
                                onclick={handleNextPage}
                                disabled={isNextDisabled}
                                variant="neutral"
                                class="slds-m-left_x-small">
                            </lightning-button>
                        </td>
                    </tr>
                </tfoot>
            </table>

            <template if:true={isAnyRecordSelected}>
                <div class="slds-m-top_medium" style="text-align: center;">
                    <lightning-button label="Next" variant="brand" onclick={handleNextSection1}></lightning-button>
                </div>
            </template>
        </template>
    </template>

    <template if:true={showSection2}>
        <p style="font-weight: bold;">To</p>
        <lightning-input
            type="text"
            value={toNames}
            style="margin-bottom: 16px; margin-top: -16px;"
            disabled>
        </lightning-input>

        <p style="font-weight: bold;">Subject</p>
        <lightning-input
            type="text"
            value={emailSubject}
            style="margin-bottom: 16px; margin-top: -16px;"
            onchange={handleSubjectChange}>
        </lightning-input>

        <p style="font-weight: bold;">Body</p>
        <lightning-input-rich-text
            value={emailBody}
            style="margin-bottom: 16px;"
            onchange={handleEmailChange}>
        </lightning-input-rich-text>

        <div style = "text-align: center;">
            <lightning-button 
                label="Previous" 
                onclick={handlePreviousSection2}>
            </lightning-button>
                &nbsp;&nbsp;
            <lightning-button 
                label="Preview"
                variant="brand"
                onclick={handleNextSection2}>
            </lightning-button>
        </div>
    </template>

    <template if:true={showSection3}>
        <div style="
            background: white; 
            padding: 24px; 
            border-radius: 8px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
            max-width: 1500px; 
            margin: 0 auto 24px auto;">
            
            <p style="font-weight: bold; margin-bottom: 4px;">To:</p>
            <lightning-input
                value={toNames}
                style="margin-top: -12px; margin-bottom: 16px;"
                disabled>
            </lightning-input>
            
            <p style="font-weight: bold; margin-bottom: 4px;">Subject:</p>
            <div style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 16px;">
                {emailSubject}
            </div>
            
            <p style="font-weight: bold; margin-bottom: 4px;">Body:</p>
            <div style="border: 1px solid #ddd; border-radius: 4px; padding: 12px;">
                <lightning-formatted-rich-text
                    value={emailBody}>
                </lightning-formatted-rich-text>
            </div>
        </div>

        <div style="text-align: center;">
            <lightning-button 
                label="Previous" 
                onclick={handlePreviousSection3}
                class="slds-m-right_small">
            </lightning-button>

            <lightning-button 
                label="Send Email" 
                onclick={handleSend}
                variant="brand">
            </lightning-button>
        </div>
    </template>

</template>